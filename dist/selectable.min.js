!function(a,b){"use strict";a.module("uis").directive("uisSelectable",[function(){return{require:"uisSortable",priority:-1,link:function(c,d,e,f){var g,h,i,j,k,l,m;k=a.extend({},c.$eval(e.uisSelectable)),k.moveWithSortable&&(l=c.$eval(e.uisSortable)||{},m="."+(l.placeholder||"ui-sortable-placeholder"),j=function(c,e){var f=e.clone(),g=a.element('<div class="ui-sortable-helpers"></div>').append(f);if(e.hasClass("ui-selected")){var h=d.find(".ui-selected"),i=!0;h.each(function(a,c){var d=b(c);if(d.is(e))return i=!1,void 0;var g=d.clone();i?g.insertBefore(f):(g.insertAfter(f),f=g),d.addClass("ui-sortable-selected")})}return g},g=function(c,e){if(e.item.hasClass("ui-selected")){var g=e.item.data("uisSortable"),h=e.item.data("uisSortable");b(l.items||"> *",d).not(m).each(function(c,d){var e,i,j=a.element(d),k=j.scope()[f.valueIdent];if(b(d).hasClass("ui-selected")){for(e=f.getCollection(),i=0;i<e.length;i++)e[i]===k&&(c=i);if(c===h.index)return;g.sortingItems.push({element:j,item:k,index:c})}}),e.item.data("uisSortable",g)}},h=function(a,b){if(b.item.hasClass("ui-selected")){var c,d,e=b.item.data("uisSortable"),f=!1,g=b.item;for(e.sortingItems.sort(function(a,b){return a.index>b.index}),d=0;d<e.sortingItems.length;d++)c=e.sortingItems[d],c.index===e.index?f=!0:f?(c.element.insertAfter(g),g=c.element):c.element.insertBefore(b.item)}},i=function(){b(".ui-sortable-selected").removeClass("ui-sortable-selected")},f.registerEvent("deactivate",i),f.registerEvent("start",g),f.registerEvent("update",h)),l.helper||d.sortable("option","helper",j),d.selectable(k)}}}])}(angular,$);